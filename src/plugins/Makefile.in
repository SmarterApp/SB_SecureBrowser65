DEPTH		= ../..
topsrcdir	= @top_srcdir@
srcdir		= @srcdir@
VPATH		= @srcdir@

include $(topsrcdir)/config/rules.mk

ifeq ($(OS_ARCH),Darwin)
  PLUGIN_FILE="SB6Flash Player.plugin"
else
ifeq ($(OS_ARCH),Linux)
  PLUGIN_FILE=libflashplayer.so
endif
endif

ifeq ($(OS_ARCH),WINNT)
  PLUGIN_FILE=NPSBF32.dll
  PLUGIN_XPT=sbflashplayer.xpt
  AUDIO_RECORDER=npAIRAudio.dll
endif

ifeq ($(OS_ARCH),WINNT)
libs:: 
	if [ $(PLUGIN_FILE) ]; then cp -r $(srcdir)/$(PLUGIN_FILE) $(DIST)/bin/plugins; fi
	if [ $(PLUGIN_XPT) ]; then cp $(srcdir)/$(PLUGIN_XPT) $(DIST)/bin/plugins; fi
	if [ $(AUDIO_RECORDER) ]; then cp -r $(srcdir)/$(AUDIO_RECORDER) $(DIST)/bin/plugins; fi
endif

ifeq ($(OS_ARCH),Darwin)
libs:: 
	if [ $(PLUGIN_FILE) ]; then ln -sf $(srcdir)/$(PLUGIN_FILE) $(DIST)/bin/plugins/; fi
endif

ifeq ($(OS_ARCH),Linux)
libs:: 
	if [ $(PLUGIN_FILE) ]; then ln -sf $(srcdir)/$(PLUGIN_FILE) $(DIST)/bin/plugins; fi
endif


ifeq ($(OS_ARCH),Linux)
libs::
	cd $(DIST)/bin; \
	if [ ! -d jre-1.6.0_31 ]; then tar jxvf $(srcdir)/jre-1.6.0_31.tar.bz2; fi
	cd $(DIST)/bin/plugins; \
	ln -sf ../jre-1.6.0_31/lib/i386/libnpjp2.so; \
	# ln -sf ../jre-1.6.0_31/plugin/i386/ns7/libjavaplugin_oji.so
endif
